var IllDownGrid=function(c,b,g,d,a,f,e){var h=$.param({user:b,passwd:g,filename:a});$.ajax({url:"https://acoustic.ifp.illinois.edu:8081/gridfs/"+c+"/"+d+"?"+h,type:"GET",dataType:"arraybuffer",timeOut:10000,xhrFields:{withCredentials:true}}).done(function(i){console.log(i.byteLength);f(i)}).fail(function(){console.log("ajax fail");e()})};var IllDownCol=function(c,b,g,d,a,f,e){var h=$.param({dbname:c,colname:d,user:b,passwd:g});$.ajax({url:"https://acoustic.ifp.illinois.edu:8081/query?"+h,data:'{filename:"'+a+'"}',type:"POST",dataType:"text",timeOut:10000,xhrFields:{withCredentials:true}}).done(function(j){var i=JSON.parse(j);console.log(i[0].filename);f(i)}).fail(function(){console.log("ajax fail");e()})};var IllUpdateCol=function(c,b,f,d,a,h,e){var g=$.param({dbname:c,colname:d,user:b,passwd:f});$.ajax({url:"https://acoustic.ifp.illinois.edu:8081/write?"+g,data:'{filename:"'+a+'"}\n{$'+h+":"+e+"}",type:"POST",dataType:"text",timeOut:10000,xhrFields:{withCredentials:true}}).done(function(i){console.log(i)}).fail(function(){console.log("ajax fail")})};var IllQueryCol=function(p,g,i,c,b,o,m){var n=3959;var f={dbname:p,colname:c,user:g,passwd:i};if(b.hasOwnProperty("limit")){f.limit=b.limit}var a=$.param(f);var e,r,l,d,k,j;if(b.hasOwnProperty("t1")&&b.hasOwnProperty("t2")){e='{recordDate:{$gte:{$date:"'+b.t1+'"}, $lte:{$date:"'+b.t2+'"}}}'}else{if(b.hasOwnProperty("t1")){e='{recordDate:{$gte:{$date:"'+b.t1+'"}}}'}else{if(b.hasOwnProperty("t2")){e='{recordDate:{$lte:{$date:"'+b.t2+'"}}}'}}}if(b.hasOwnProperty("f1")&&b.hasOwnProperty("f2")){r=",{minFreq:{$gte:"+b.f1+"}},{maxFreq:{$lte:"+b.f2+"}}"}else{if(b.hasOwnProperty("f1")){r=",{minFreq:{$gte:"+b.f1+"}}"}else{if(b.hasOwnProperty("f2")){r=",{maxFreq:{$lte:"+b.f2+"}}"}else{r=""}}}if(b.hasOwnProperty("dur1")&&b.hasOwnProperty("dur2")){l=",{duration:{$gte:"+b.dur1+", $lte:"+b.dur2+"}}"}else{if(b.hasOwnProperty("dur1")){l=",{duration:{$gte:"+b.dur1+"}}"}else{if(b.hasOwnProperty("dur2")){l=",{duration:{$lte:"+b.dur2+"}}"}else{l=""}}}if(b.hasOwnProperty("lnp1")&&b.hasOwnProperty("lnp2")){d=",{logProb:{$gte:"+b.lnp1+", $lte:"+b.lnp2+"}}"}else{if(b.hasOwnProperty("lnp1")){d=",{logProb:{$gte:"+b.lnp1+"}}"}else{if(b.hasOwnProperty("lnp2")){d=",{logProb:{$lte:"+b.lnp2+"}}"}else{d=""}}}if(b.hasOwnProperty("loc")&&b.hasOwnProperty("rad")){k=",{location:{$geoWithin:{$centerSphere:[["+b.loc[1]+","+b.loc[0]+"], "+b.rad/n+"]}}}"}else{k=""}if(b.hasOwnProperty("kw")){j=',{$text: {$search:"'+b.kw+'"}}'}else{j=""}var h="{$and:["+e+r+l+d+k+j+"]}";$.ajax({url:"https://acoustic.ifp.illinois.edu:8081/query?"+a,data:h,type:"POST",dataType:"text",timeOut:10000}).done(function(s){var q=JSON.parse(s);o(q)}).fail(function(){console.log("ajax fail");m()})};